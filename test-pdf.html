<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test PDF Generation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .btn {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .logs {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Test de G√©n√©ration PDF - CV G√©n√©rateur</h1>
            <p>V√©rifiez que le t√©l√©chargement PDF fonctionne parfaitement</p>
        </div>

        <div class="test-section">
            <h3>üìã Checklist de Test</h3>
            <ul>
                <li id="check1">‚úÖ Application Next.js d√©marr√©e</li>
                <li id="check2">‚è≥ Test de navigation vers CV-Pro</li>
                <li id="check3">‚è≥ Test de cr√©ation d'aper√ßu CV</li>
                <li id="check4">‚è≥ Test de t√©l√©chargement PDF depuis CV-Pro</li>
                <li id="check5">‚è≥ Test de sauvegarde CV</li>
                <li id="check6">‚è≥ Test de t√©l√©chargement PDF depuis Dashboard</li>
                <li id="check7">‚è≥ Test des couleurs (pas d'erreur OKLCH)</li>
                <li id="check8">‚è≥ Test des images</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>üöÄ Actions de Test</h3>
            <button class="btn" onclick="testNavigation()">1. Tester Navigation</button>
            <button class="btn" onclick="testPdfGeneration()">2. Tester G√©n√©ration PDF</button>
            <button class="btn" onclick="testColors()">3. Tester Couleurs</button>
            <button class="btn" onclick="clearLogs()">üßπ Effacer Logs</button>
        </div>

        <div class="test-section">
            <h3>üìä R√©sultats des Tests</h3>
            <div id="testResults"></div>
        </div>

        <div class="test-section">
            <h3>üìù Logs de Console</h3>
            <div id="consoleLogs" class="logs">
Logs appara√Ætront ici...
            </div>
        </div>

        <div class="test-section">
            <h3>üéØ Instructions Manuelles</h3>
            <ol>
                <li><strong>Ouvrez http://localhost:3000/cv-pro</strong></li>
                <li><strong>Remplissez le formulaire</strong> avec vos informations</li>
                <li><strong>Ajoutez une photo</strong> (facultatif)</li>
                <li><strong>Cliquez sur "Aper√ßu"</strong> pour voir le CV</li>
                <li><strong>Cliquez sur l'ic√¥ne de t√©l√©chargement</strong> dans l'aper√ßu</li>
                <li><strong>V√©rifiez que le PDF se t√©l√©charge</strong> sans erreur</li>
                <li><strong>Sauvegardez le CV</strong> avec "Sauvegarder"</li>
                <li><strong>Allez sur http://localhost:3000/my-cvs</strong></li>
                <li><strong>Cliquez sur l'ic√¥ne de t√©l√©chargement</strong> d'un CV sauv√©</li>
                <li><strong>V√©rifiez que le PDF se t√©l√©charge</strong> depuis le dashboard</li>
            </ol>
        </div>

        <div class="test-section success">
            <h3>‚úÖ Crit√®res de Succ√®s</h3>
            <ul>
                <li>‚úÖ Aucune erreur OKLCH dans la console</li>
                <li>‚úÖ PDF se t√©l√©charge correctement</li>
                <li>‚úÖ Images s'affichent dans le PDF</li>
                <li>‚úÖ Couleurs correctement appliqu√©es</li>
                <li>‚úÖ Pas d'erreur "listener asynchronous"</li>
                <li>‚úÖ Modal de t√©l√©chargement fonctionne</li>
            </ul>
        </div>
    </div>

    <script>
        // Capturer les logs de console
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToLogs(type, message) {
            const logsDiv = document.getElementById('consoleLogs');
            const timestamp = new Date().toLocaleTimeString();
            const typeEmoji = type === 'error' ? '‚ùå' : type === 'warn' ? '‚ö†Ô∏è' : 'üîç';
            logsDiv.innerHTML += `[${timestamp}] ${typeEmoji} ${type.toUpperCase()}: ${message}\n`;
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLogs('log', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLogs('error', args.join(' '));
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToLogs('warn', args.join(' '));
        };
        
        function testNavigation() {
            addTestResult('Navigation', 'En cours...', 'info');
            window.open('http://localhost:3000/cv-pro', '_blank');
            setTimeout(() => {
                addTestResult('Navigation', 'Page CV-Pro ouverte. V√©rifiez manuellement.', 'success');
                updateCheckItem('check2', '‚úÖ Test de navigation vers CV-Pro');
            }, 1000);
        }
        
        function testPdfGeneration() {
            addTestResult('PDF Generation', 'Veuillez tester manuellement depuis l\'application', 'info');
        }
        
        function testColors() {
            addTestResult('Colors', 'V√©rifiez qu\'il n\'y a pas d\'erreur OKLCH dans les logs', 'info');
        }
        
        function clearLogs() {
            document.getElementById('consoleLogs').innerHTML = 'Logs effac√©s...\n';
        }
        
        function addTestResult(test, message, type) {
            const resultsDiv = document.getElementById('testResults');
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : '';
            resultsDiv.innerHTML += `<div class="test-section ${className}"><strong>${test}:</strong> ${message}</div>`;
        }
        
        function updateCheckItem(id, text) {
            document.getElementById(id).textContent = text;
        }
        
        // Auto-check de d√©marrage
        setTimeout(() => {
            console.log('üöÄ Test de g√©n√©ration PDF initialis√©');
            console.log('üìã V√©rifiez les √©tapes manuellement dans l\'application Next.js');
        }, 1000);
    </script>
</body>
</html>
